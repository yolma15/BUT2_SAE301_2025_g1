<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Locfit</title>
    <link rel="stylesheet" href="/css/header.css" />
</head>

<body>
    <header class="site-header">
        <a href="/home" class="Logo">
            <img src="/img/Logo blanc sur orange.png" alt="logo Locfit" />
        </a>

        <nav class="main-nav">
            <% if (isLoggedIn) { %>
                
                <% if (userRole === 'client') { %>
                    <a href="/home">Accueil</a>
                    <a href="/catalogue">Catalogue</a>
                    <a href="/mes-locations">Mes locations</a>
                
                <% } else if (userRole === 'admin') { %>
                    <a href="/home">Accueil</a>
                    <a href="/admin/dashboard">Tableau de bord</a>
                
                <% } else if (userRole === 'agent') { %>
                    <a href="/home">Accueil</a>
                    <a href="/agent/ajout_produit">Ajouts Produits</a>
                    <a href="/agent/returnprod">Retours Produits</a>
                <% } %>

            <% } else { %>
                <a href="/home">Accueil</a>
                <a href="/catalogue">Catalogue</a>
                <a href="/login">Mes locations</a>
            <% } %>
        </nav>

        <div class="user-area">
            <% if (!isLoggedIn) { %>
                <a class="btn btn-login" href="/login">Se connecter</a>
                <a class="btn btn-register" href="/register">S’inscrire</a>
            <% } else { %>
                <div class="user-menu">
                    
                    <% 
                        let avatarSrc = '/img/default-avatar.png';
                        if (typeof userImg) {
                            avatarSrc = '/img/' + userImg;
                        }
                    %>

                    <img class="avatar" 
                         src="<%= avatarSrc %>" 
                         alt="profil" 
                         style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;" />

                    <span class="username"><%= typeof username !== 'undefined' ? username : 'Utilisateur' %></span>

                    <div class="dropdown">
                        <button class="dropdown-toggle" aria-haspopup="true" aria-expanded="false">
                            ▾
                        </button>
                        
                        <div class="dropdown-menu" role="menu">
                            <% if (userRole === 'client') { %>
                                <a href="/profil" class="dropdown-item">Mes informations</a>
                                <form action="/logout" method="post">
                                    <button type="submit" class="dropdown-item danger">
                                        Se déconnecter
                                    </button>
                                </form>
                            <% } else { %>
                                <form action="/logout" method="post">
                                    <button type="submit" class="dropdown-item danger">
                                        Se déconnecter
                                    </button>
                                </form>
                            <% } %>
                        </div>
                    </div>
                </div>
            <% } %>
        </div>
    </header>
</body>

</html>